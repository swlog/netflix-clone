name: Deploy to GitHub Pages

on:
  # 'main' ë¸Œëœì¹˜ì— í‘¸ì‹œê°€ ë°œìƒí–ˆì„ ë•Œ ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
  push:
    branches:
      - main
  
  # ìˆ˜ë™ ì‹¤í–‰ì„ í—ˆìš©í•©ë‹ˆë‹¤.
  workflow_dispatch:

# ì´ì „ ë°°í¬ ì‘ì—…ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ìƒˆ ì‘ì—…ì´ ì‹œì‘ë˜ëŠ” ê²ƒì„ ë°©ì§€í•©ë‹ˆë‹¤.
concurrency:
  cancel-in-progress: true
  group: ${{ github.workflow }}-${{ github.ref }}

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    environment: 
        name: github-pages
        url: ${{ steps.deployment.outputs.page_url }}

    steps:
      - name: â¬‡ï¸ Checkout repository
        uses: actions/checkout@v4
      
      # gh-pages íŒ¨í‚¤ì§€ ì‚¬ìš© ì‹œ SSH í‚¤ê°€ í•„ìš”í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ê¶Œì¥ë˜ëŠ” ì„¤ì •ì…ë‹ˆë‹¤.
      # Deploy keyë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ê¸°ë³¸ GITHUB_TOKENì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ìƒëµ ê°€ëŠ¥í•©ë‹ˆë‹¤.
      # ì´ ì›Œí¬í”Œë¡œìš°ëŠ” ê¸°ë³¸ GITHUB_TOKENì„ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •ë©ë‹ˆë‹¤.

      - name: âš™ï¸ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # ì‚¬ìš© ì¤‘ì¸ Node.js ë²„ì „ì„ ì§€ì •í•˜ì„¸ìš”.
          cache: 'npm'

      - name: ğŸ“¦ Install dependencies
        run: npm install

      - name: ğŸš€ Deploy to GitHub Pages using gh-pages
        # `deploy` ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. (ì´ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ `predeploy`(build)ì™€ `deploy`(gh-pages -d build)ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.)
        run: npm run deploy
        env:
          # gh-pages íŒ¨í‚¤ì§€ê°€ ë°°í¬ë¥¼ ìœ„í•´ ì‚¬ìš©í•  í† í°ì„ ì„¤ì •í•©ë‹ˆë‹¤.
          # GITHUB_TOKENì€ GitHub Actionsê°€ ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µí•˜ëŠ” í† í°ì…ë‹ˆë‹¤.
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          
      - name: ğŸ”— Setup GitHub Pages URL
        id: deployment
        uses: actions/deploy-pages@v4 # ë°°í¬ URLì„ í™˜ê²½ì— ì„¤ì •í•©ë‹ˆë‹¤.
