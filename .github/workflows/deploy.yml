name: Deploy to GitHub Pages

on:
  # 'main' ë¸Œëœì¹˜ì— í‘¸ì‹œê°€ ë°œìƒí–ˆì„ ë•Œ ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
  push:
    branches:
      - main
  
  # ìˆ˜ë™ ì‹¤í–‰ì„ í—ˆìš©í•©ë‹ˆë‹¤.
  workflow_dispatch:

# ì´ì „ ë°°í¬ ì‘ì—…ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ìƒˆ ì‘ì—…ì´ ì‹œì‘ë˜ëŠ” ê²ƒì„ ë°©ì§€í•©ë‹ˆë‹¤.
concurrency:
  cancel-in-progress: true
  group: ${{ github.workflow }}-${{ github.ref }}

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    environment: 
        name: github-pages
        url: ${{ steps.deployment.outputs.page_url }}

    steps:
      - name: â¬‡ï¸ Checkout repository
        uses: actions/checkout@v4
      
      - name: âš™ï¸ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # ì´ì „ì— Node.js 20.0.0 ì´ìƒ ìš”êµ¬ë¡œ í™•ì¸ë¨
          cache: 'npm'

      - name: ğŸ“¦ Install dependencies
        # ë§Œì•½ ì´ì „ì— `npm ci` ê´€ë ¨ ì˜¤ë¥˜ë¥¼ ë¡œì»¬ì—ì„œ í•´ê²°í•˜ì§€ ëª»í–ˆë‹¤ë©´, 
        # ì„ì‹œë¡œ `npm install`ì„ ì‚¬ìš©í•˜ì—¬ ì§„í–‰í•˜ê³  ë¡œì»¬ì—ì„œ lock íŒŒì¼ì„ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”.
        run: npm install 

      - name: ğŸ‘¤ Configure Git User
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "41898282+github-actions[bot]@users.noreply.github.com"
          
      - name: ğŸš€ Deploy to GitHub Pages using gh-pages
        # `deploy` ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ (ë‚´ë¶€ì ìœ¼ë¡œ build -> gh-pages í‘¸ì‹œ)
        run: npm run deploy
        env:
          # gh-pages íŒ¨í‚¤ì§€ê°€ ë°°í¬ë¥¼ ìœ„í•´ ì‚¬ìš©í•  í† í° ì„¤ì •
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          
      - name: ğŸ”— Setup GitHub Pages URL
        id: deployment
        uses: actions/deploy-pages@v4